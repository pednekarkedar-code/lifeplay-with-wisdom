<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LifePlay - Sports & Wellness Hub | WisdomLab</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }
        .hidden { display: none !important; }
    </style>
</head>
<body class="bg-gray-50">
    <div id="app"></div>
    <script>
        // App State
        let state = {
            currentView: 'home',
            isAdmin: false,
            selectedSport: '',
            selectedDate: '',
            selectedTime: '',
            numPersons: 1,
            customerName: '',
            customerPhone: '',
            customerEmail: '',
            showPayment: false,
            transactionId: '',
            bookingComplete: false,
            bookings: JSON.parse(localStorage.getItem('lifeplay_bookings')) || [],
            appData: {
                venue: {
                    name: 'LifePlay Sports & Wellness Hub',
                    subtitle: 'Play Life... Well!',
                    parentOrg: 'WisdomLab - Learning, Innovation & Facilitation Ecosystem',
                    hours: '9:30 AM - 5:30 PM',
                    days: 'Monday - Saturday',
                    specialBooking: 'Available on request with 24 hours prior notice',
                    courts: 1
                },
                sports: [
                    {
                        id: 1,
                        name: 'Badminton',
                        icon: 'üè∏',
                        pricePerPerson: 250,
                        duration: '1 hour',
                        maxPersons: 4
                    },
                    {
                        id: 2,
                        name: 'Pickleball',
                        icon: 'üéæ',
                        pricePerPerson: 250,
                        duration: '1 hour',
                        maxPersons: 4
                    }
                ],
                timeSlots: [
                    '09:30 AM', '10:30 AM', '11:30 AM', '12:30 PM',
                    '01:30 PM', '02:30 PM', '03:30 PM', '04:30 PM'
                ],
                contact: {
                    phone: '8007192996',
                    email: 'inteloc@gmail.com',
                    address: 'LifePlay, WisdomLab, N 66, Phase IV, Verna Industrial Estate, Verna, South Goa, Goa',
                    mapLink: 'https://maps.google.com/?q=15.3647,73.9912'
                }
            }
        };

        // Utility Functions
        function calculateTotal() {
            const sport = state.appData.sports.find(s => s.name === state.selectedSport);
            return sport ? sport.pricePerPerson * state.numPersons : 0;
        }

        function generateTransactionId() {
            return 'TXN' + Date.now() + Math.floor(Math.random() * 1000);
        }

        function payWithRazorpay() {
            const total = calculateTotal();
            if (total === 0) {
                alert('Invalid amount');
                return;
            }

            var options = {
                "key": "rzp_test_YOUR_KEY_HERE", // ‚Üê‚Üê‚Üê REPLACE WITH YOUR RAZORPAY TEST KEY
                "amount": total * 100, // paise
                "currency": "INR",
                "name": state.appData.venue.name,
                "description": `${state.selectedSport} √ó ${state.numPersons} person(s) on ${state.selectedDate} at ${state.selectedTime}`,
                "image": "https://i.ibb.co/rK7qbKfj/Logo-Final.jpg",
                "handler": function (response) {
                    if (response.razorpay_payment_id) {
                        state.transactionId = response.razorpay_payment_id;
                        confirmBooking();
                    }
                },
                "prefill": {
                    "name": state.customerName,
                    "contact": state.customerPhone,
                    "email": state.customerEmail
                },
                "theme": {
                    "color": "#16a34a"
                },
                "modal": {
                    "ondismiss": function () {
                        alert('Payment cancelled. You can try again.');
                    }
                }
            };

            var rzp = new Razorpay(options);
            rzp.on('payment.failed', function (response) {
                alert('Payment failed: ' + response.error.description);
            });
            rzp.open();
        }

        function sendWhatsAppConfirmation() {
            const message = `üéâ *Booking Confirmed!*
*LifePlay Sports & Wellness Hub*
üìã Booking Details:
‚Ä¢ Sport: ${state.selectedSport}
‚Ä¢ Date: ${state.selectedDate}
‚Ä¢ Time: ${state.selectedTime}
‚Ä¢ Persons: ${state.numPersons}
‚Ä¢ Amount Paid: ‚Çπ${calculateTotal()}
‚Ä¢ Transaction ID: ${state.transactionId}
üë§ Customer: ${state.customerName}
üìû Phone: ${state.customerPhone}
üìç Location: N 66, Phase IV, Verna Industrial Estate, Verna, South Goa
üìû Contact: 8007192996
Thank you for choosing LifePlay! üè∏
Play Life... Well! üí™`;
            const whatsappUrl = `https://wa.me/${state.customerPhone.replace(/\D/g, '')}?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }

        function isValidBookingDate(dateString) {
            const selected = new Date(dateString);
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const tomorrow = new Date(today);
            tomorrow.setDate(tomorrow.getDate() + 1);
            const dayOfWeek = selected.getDay();
            return selected >= tomorrow && dayOfWeek !== 0; // no Sundays
        }

        function resetBooking() {
            state.selectedSport = '';
            state.selectedDate = '';
            state.selectedTime = '';
            state.numPersons = 1;
            state.customerName = '';
            state.customerPhone = '';
            state.customerEmail = '';
            state.showPayment = false;
            state.transactionId = '';
            state.bookingComplete = false;
        }

        function confirmBooking() {
            const newBooking = {
                id: Date.now(),
                sport: state.selectedSport,
                date: state.selectedDate,
                time: state.selectedTime,
                persons: state.numPersons,
                total: calculateTotal(),
                customer: {
                    name: state.customerName,
                    phone: state.customerPhone,
                    email: state.customerEmail
                },
                transactionId: state.transactionId,
                timestamp: new Date().toISOString(),
                status: 'Confirmed & Paid'
            };

            state.bookings.push(newBooking);
            localStorage.setItem('lifeplay_bookings', JSON.stringify(state.bookings));

            sendWhatsAppConfirmation();
            state.bookingComplete = true;
            render();

            setTimeout(() => {
                resetBooking();
                state.currentView = 'home';
                render();
            }, 5000);
        }

        // === VIEWS ===
        function HomeView() {
            // (unchanged ‚Äî same as your original)
            return `
                <div class="min-h-screen bg-gradient-to-br from-green-50 via-blue-50 to-orange-50 p-4">
                    <div class="max-w-md mx-auto">
                        <!-- Header -->
                        <div class="bg-white rounded-2xl shadow-xl p-6 mb-6 relative">
                            <button onclick="changeView('adminLogin')" class="absolute top-4 right-4 p-2 hover:bg-gray-100 rounded-full transition-colors">
                                ‚öôÔ∏è
                            </button>
                            <div class="text-center mb-4">
                                <div class="bg-gradient-to-r from-orange-50 via-green-50 to-blue-50 p-6 rounded-xl mb-4">
                                    <img src="https://i.ibb.co/rK7qbKfj/Logo-Final.jpg" alt="LifePlay" class="w-full max-w-sm mx-auto" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                                    <div style="display:none;" class="py-2">
                                        <div class="flex items-center justify-center gap-2 mb-3">
                                            <span class="text-4xl">üè∏</span>
                                            <div class="text-5xl font-bold tracking-tight leading-none">
                                                <span class="text-green-600">Life</span><span class="text-blue-600">Play</span><span class="text-xs align-super text-gray-600">SM</span>
                                            </div>
                                            <span class="text-4xl">üßò</span>
                                        </div>
                                        <p class="text-xl text-gray-700 font-semibold italic mb-2">Play Life... Well!</p>
                                        <p class="text-red-600 font-bold text-lg tracking-wide">SPORTS & WELLNESS HUB</p>
                                    </div>
                                </div>
                                <div class="border-t-2 border-gray-200 pt-4 mt-4">
                                    <p class="text-xs text-gray-600 font-medium mb-3">AN INSPIRING INITIATIVE OF</p>
                                    <div class="bg-gray-50 p-3 rounded-lg inline-block">
                                        <img src="https://i.ibb.co/MkLrzSLG/IMG-20260115-WA0021.jpg" alt="WisdomLab" class="h-10 mx-auto" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                        <div style="display:none;" class="flex items-center justify-center gap-1 py-1">
                                            <span class="text-2xl font-bold tracking-wider text-black">WISD</span>
                                            <div class="w-6 h-6 border-4 border-black rounded-full flex items-center justify-center mx-1">
                                                <div class="w-2 h-2 bg-black rounded-full"></div>
                                            </div>
                                            <span class="text-2xl font-bold tracking-wider text-black">MLAB</span>
                                            <span class="text-xs align-top text-black font-bold">¬Æ</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="bg-gradient-to-r from-green-100 to-blue-100 rounded-xl p-4 space-y-2">
                                <div class="flex items-center gap-2 text-sm">
                                    <span>üïê</span>
                                    <span class="text-gray-700">${state.appData.venue.hours} ‚Ä¢ ${state.appData.venue.days}</span>
                                </div>
                                <div class="flex items-start gap-2 text-xs text-gray-600">
                                    <span>üìÖ</span>
                                    <span>${state.appData.venue.specialBooking}</span>
                                </div>
                            </div>
                        </div>
                        <!-- Sports Booking -->
                        <div class="bg-white rounded-2xl shadow-xl p-6 mb-6">
                            <h2 class="text-2xl font-bold text-gray-800 mb-4">Book Your Slot</h2>
                            ${state.appData.sports.map(sport => `
                                <button onclick="selectSport('${sport.name}')" class="w-full bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 text-white rounded-xl p-5 mb-3 transition-all transform hover:scale-105 shadow-lg">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center gap-4">
                                            <span class="text-4xl">${sport.icon}</span>
                                            <div class="text-left">
                                                <h3 class="text-xl font-bold">${sport.name}</h3>
                                                <p class="text-sm opacity-90">‚Çπ${sport.pricePerPerson}/person/hour</p>
                                            </div>
                                        </div>
                                        <span class="text-2xl">‚Üí</span>
                                    </div>
                                </button>
                            `).join('')}
                        </div>
                        <!-- Contact -->
                        <div class="bg-white rounded-2xl shadow-xl p-6">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">Contact Us</h3>
                            <div class="space-y-3">
                                <div class="flex items-center gap-3">
                                    <span>üìû</span>
                                    <span class="text-gray-700">${state.appData.contact.phone}</span>
                                </div>
                                <div class="flex items-center gap-3">
                                    <span>‚úâÔ∏è</span>
                                    <span class="text-gray-700">${state.appData.contact.email}</span>
                                </div>
                                <div class="flex items-start gap-3">
                                    <span>üìç</span>
                                    <div>
                                        <span class="text-gray-700">${state.appData.contact.address}</span>
                                        <a href="${state.appData.contact.mapLink}" target="_blank" class="block text-blue-600 hover:text-blue-700 text-sm font-semibold mt-1">
                                            üìç Open in Google Maps ‚Üí
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function BookingView() {
            const sport = state.appData.sports.find(s => s.name === state.selectedSport);

            if (state.bookingComplete) {
                return `
                    <div class="min-h-screen bg-gradient-to-br from-green-50 to-emerald-100 p-4 flex items-center justify-center">
                        <div class="bg-white rounded-2xl shadow-2xl p-8 max-w-md text-center">
                            <div class="text-green-500 text-6xl mb-4">‚úì</div>
                            <h2 class="text-3xl font-bold text-gray-800 mb-2">Payment Successful! üéâ</h2>
                            <p class="text-gray-600 mb-4">Your booking is confirmed</p>
                            <div class="bg-gray-50 rounded-xl p-4 my-4 text-left">
                                <p class="text-sm text-gray-600 mb-1">Sport: <span class="font-semibold text-gray-800">${state.selectedSport}</span></p>
                                <p class="text-sm text-gray-600 mb-1">Date: <span class="font-semibold text-gray-800">${state.selectedDate}</span></p>
                                <p class="text-sm text-gray-600 mb-1">Time: <span class="font-semibold text-gray-800">${state.selectedTime}</span></p>
                                <p class="text-sm text-gray-600 mb-1">Persons: <span class="font-semibold text-gray-800">${state.numPersons}</span></p>
                                <p class="text-sm text-gray-600 mb-1">Transaction ID: <span class="font-semibold text-green-600">${state.transactionId}</span></p>
                                <p class="text-lg text-green-600 font-bold mt-2">Paid: ‚Çπ${calculateTotal()}</p>
                            </div>
                            <div class="bg-green-100 border-2 border-green-500 rounded-lg p-3 mb-4">
                                <p class="text-sm text-green-800">üì± WhatsApp confirmation sent</p>
                            </div>
                            <p class="text-sm text-gray-500">Redirecting to home...</p>
                        </div>
                    </div>
                `;
            }

            if (state.showPayment) {
                return PaymentView();
            }

            return `
                <div class="min-h-screen bg-gradient-to-br from-green-50 to-blue-50 p-4">
                    <div class="max-w-md mx-auto">
                        <div class="bg-white rounded-2xl shadow-xl p-4 mb-6 flex items-center gap-4">
                            <button onclick="backToHome()" class="p-2 hover:bg-gray-100 rounded-full">üè†</button>
                            <div>
                                <h2 class="text-2xl font-bold text-gray-800 flex items-center gap-2">
                                    <span>${sport?.icon}</span> ${state.selectedSport}
                                </h2>
                                <p class="text-sm text-gray-600">‚Çπ${sport?.pricePerPerson}/person ‚Ä¢ ${sport?.duration}</p>
                            </div>
                        </div>
                        <div class="bg-white rounded-2xl shadow-xl p-6 space-y-5">
                            <div>
                                <label class="block text-sm font-semibold text-gray-700 mb-2">Select Date</label>
                                <input type="date" id="dateInput" onchange="updateDate(this.value)" min="${new Date(Date.now() + 86400000).toISOString().split('T')[0]}" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none">
                                <p class="text-xs text-orange-600 mt-1">‚ö†Ô∏è Booking requires 24 hours advance notice</p>
                                ${state.selectedDate && !isValidBookingDate(state.selectedDate) ? '<p class="text-xs text-red-600 mt-1">‚ùå Invalid date (weekday only, 24hrs ahead)</p>' : ''}
                            </div>

                            ${state.selectedDate && isValidBookingDate(state.selectedDate) ? `
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Select Time Slot</label>
                                    <div class="grid grid-cols-2 gap-2">
                                        ${state.appData.timeSlots.map(slot => {
                                            const isBooked = state.bookings.some(b => b.date === state.selectedDate && b.time === slot);
                                            return `
                                                <button ${!isBooked ? `onclick="selectTime('${slot}')"` : 'disabled'}
                                                    class="p-3 rounded-xl border-2 font-semibold transition-all ${state.selectedTime === slot ? 'bg-blue-500 text-white border-blue-500' : isBooked ? 'bg-red-500 text-white border-red-500 opacity-70' : 'bg-white border-gray-200 hover:border-blue-300'}">
                                                    ${slot}
                                                    ${isBooked ? '<br><span class="text-xs">Booked</span>' : ''}
                                                </button>
                                            `;
                                        }).join('')}
                                    </div>
                                </div>
                            ` : ''}

                            ${state.selectedTime ? `
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Number of Persons</label>
                                    <div class="flex items-center gap-3">
                                        <button onclick="decrementPersons()" class="w-12 h-12 bg-gray-200 rounded-xl font-bold text-xl hover:bg-gray-300">-</button>
                                        <span class="text-2xl font-bold text-gray-800 w-12 text-center">${state.numPersons}</span>
                                        <button onclick="incrementPersons(${sport?.maxPersons})" class="w-12 h-12 bg-gray-200 rounded-xl font-bold text-xl hover:bg-gray-300">+</button>
                                        <span class="text-sm text-gray-600 ml-2">(Max ${sport?.maxPersons})</span>
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Your Name</label>
                                    <input type="text" oninput="updateName(this.value)" placeholder="Enter your full name" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Phone Number</label>
                                    <input type="tel" oninput="updatePhone(this.value)" placeholder="+91 98765 43210" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none">
                                </div>
                                <div>
                                    <label class="block text-sm font-semibold text-gray-700 mb-2">Email (Optional)</label>
                                    <input type="email" oninput="updateEmail(this.value)" placeholder="your@email.com" class="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none">
                                </div>
                                <div class="bg-gradient-to-r from-green-100 to-blue-100 rounded-xl p-5">
                                    <div class="flex justify-between items-center mb-4">
                                        <span class="text-gray-700 font-semibold">Total Amount:</span>
                                        <span class="text-3xl font-bold text-green-600">‚Çπ${calculateTotal()}</span>
                                    </div>
                                    <button onclick="proceedToPayment()" ${!state.customerName || !state.customerPhone ? 'disabled' : ''} class="w-full bg-gradient-to-r from-green-500 to-blue-500 text-white py-4 rounded-xl font-bold text-lg hover:from-green-600 hover:to-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all">
                                        Proceed to Secure Payment ‚Üí
                                    </button>
                                </div>
                            ` : ''}
                        </div>
                    </div>
                </div>
            `;
        }

        function PaymentView() {
            return `
                <div class="min-h-screen bg-gradient-to-br from-green-50 to-blue-50 p-4">
                    <div class="max-w-md mx-auto">
                        <div class="bg-white rounded-2xl shadow-xl p-4 mb-6 flex items-center gap-4">
                            <button onclick="backToBooking()" class="p-2 hover:bg-gray-100 rounded-full">‚Üê</button>
                            <h2 class="text-2xl font-bold text-gray-800">Secure Payment</h2>
                        </div>
                        <div class="bg-white rounded-2xl shadow-xl p-6 text-center">
                            <div class="bg-gradient-to-r from-green-100 to-blue-100 rounded-xl p-6 mb-8">
                                <p class="text-gray-700 mb-2">Total Amount</p>
                                <p class="text-5xl font-bold text-green-600">‚Çπ${calculateTotal()}</p>
                                <p class="text-sm text-gray-600 mt-3">${state.numPersons} √ó ‚Çπ250 per person</p>
                            </div>
                            <p class="text-lg font-semibold text-gray-800 mb-2">Powered by Razorpay</p>
                            <p class="text-sm text-gray-600 mb-6">UPI ‚Ä¢ Cards ‚Ä¢ Netbanking ‚Ä¢ Wallets</p>
                            <button onclick="payWithRazorpay()" class="w-full bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-600 hover:to-blue-600 text-white py-5 rounded-xl font-bold text-xl shadow-lg transition-all transform hover:scale-105">
                                Pay ‚Çπ${calculateTotal()} Now ‚Üí
                            </button>
                            <p class="text-xs text-gray-500 mt-6">Your payment is 100% secure and encrypted</p>
                        </div>
                    </div>
                </div>
            `;
        }

        // Admin views unchanged (same as your original)
        function AdminLoginView() { /* ... your original code ... */ }
        function AdminDashboardView() { /* ... your original code ... */ }

        // Event Handlers (mostly unchanged)
        function changeView(view) { state.currentView = view; render(); }
        function selectSport(sportName) { state.selectedSport = sportName; state.currentView = 'booking'; render(); }
        function updateDate(value) { state.selectedDate = value; render(); }
        function selectTime(time) { state.selectedTime = time; render(); }
        function incrementPersons(max) { if (state.numPersons < max) { state.numPersons++; render(); } }
        function decrementPersons() { if (state.numPersons > 1) { state.numPersons--; render(); } }
        function updateName(value) { state.customerName = value; }
        function updatePhone(value) { state.customerPhone = value; }
        function updateEmail(value) { state.customerEmail = value; }
        function backToHome() { resetBooking(); state.currentView = 'home'; render(); }
        function backToBooking() { state.showPayment = false; render(); }
        function proceedToPayment() { state.showPayment = true; render(); }
        function adminLogin() { /* your original */ }
        function adminLogout() { /* your original */ }

        // Render
        function render() {
            const app = document.getElementById('app');
            switch(state.currentView) {
                case 'home': app.innerHTML = HomeView(); break;
                case 'booking': app.innerHTML = BookingView(); break;
                case 'adminLogin': app.innerHTML = AdminLoginView(); break;
                case 'admin': app.innerHTML = state.isAdmin ? AdminDashboardView() : HomeView(); break;
                default: app.innerHTML = HomeView();
            }
        }

        render();
    </script>
</body>
</html>
